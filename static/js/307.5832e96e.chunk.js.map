{"version":3,"file":"static/js/307.5832e96e.chunk.js","mappings":"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","sources":["nostr/Worker.js","../webpack/bootstrap","../webpack/runtime/chunk loaded","../webpack/runtime/define property getters","../webpack/runtime/ensure chunk","../webpack/runtime/get javascript chunk filename","../webpack/runtime/get mini-css chunk filename","../webpack/runtime/hasOwnProperty shorthand","../webpack/runtime/publicPath","../webpack/runtime/importScripts chunk loading","../webpack/runtime/startup chunk dependencies","../webpack/startup"],"sourcesContent":["import * as Comlink from \"comlink\";\nimport {SimplePool} from \"nostr-tools\";\n\nexport class BackgroundNostr {\n    constructor() {\n        this.seenOn = {};\n        this.subs = {};\n        this.relays = {};\n        this.pool = new SimplePool();\n        this.poolCreated = Date.now();\n    }\n\n    setup(relays) {\n        this.relays = relays;\n    }\n\n    getPool() {\n        if (Date.now() - this.poolCreated > 120000) {\n            /* Renew pool every 2 minutes */\n            this.pool.close(this.relays);\n\n            this.pool = new SimplePool();\n            this.poolCreated = Date.now();\n        }\n\n        return this.pool;\n    }\n\n    fetch(filters, quitMs = 0) {\n        return new Promise((resolve, reject) => {\n            const pool = this.getPool();\n            const sub = pool.sub(this.relays, filters);\n            const events = [];\n\n            const quit = () => {\n                sub.unsub();\n                resolve(events);\n            };\n\n            let timer = quitMs > 0 ? setTimeout(() => {\n                quit();\n            }, quitMs) : null;\n\n            sub.on(\"event\", event => {\n                events.push(event);\n                this.seenOn[event.id] = pool.seenOn(event.id);\n\n                if (quitMs > 0) {\n                    clearTimeout(timer);\n                    timer = setTimeout(() => {\n                        quit();\n                    }, quitMs);\n                }\n            });\n\n            if (quitMs === 0) {\n                sub.on(\"eose\", () => {\n                    quit();\n                });\n            }\n        });\n    }\n\n    unsub(subId) {\n        if (this.subs[subId]) {\n            this.subs[subId].unsub();\n            delete this.subs[subId];\n        }\n    }\n\n    sub(filters, onEvent, unsub = true) {\n        const subId = Math.random().toString().slice(2);\n        const pool = this.getPool();\n        const sub = pool.sub(this.relays, filters, {\n            id: subId\n        });\n\n        sub.on(\"event\", event => {\n            this.seenOn[event.id] = pool.seenOn(event.id);\n            onEvent(event);\n        });\n\n        sub.on(\"eose\", () => {\n            if (unsub) this.unsub(subId);\n        });\n\n        this.subs[subId] = sub;\n\n        return subId;\n    }\n\n    async findHealthyRelay(relays) {\n        const pool = this.getPool();\n        for (const relay of relays) {\n            try {\n                await pool.ensureRelay(relay);\n\n                return relay;\n            } catch (e) {\n                // Do nothing\n            }\n        }\n\n        throw new Error(\"Couldn't find a working relay.\");\n    }\n\n    async where(eventId) {\n        let try_ = 0;\n        while (!this.seenOn[eventId]) {\n            await this.fetch([{\n                ids: [eventId]\n            }]);\n\n            try_++;\n\n            if (try_ === 3) break;\n        }\n\n        if (!this.seenOn[eventId]) throw new Error(\"Couldn't find root event.\");\n\n        return this.findHealthyRelay(this.seenOn[eventId]);\n    }\n}\n\nComlink.expose(new BackgroundNostr());","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n// the startup function\n__webpack_require__.x = () => {\n\t// Load entry module and return exports\n\t// This entry module depends on other loaded chunks and execution need to be delayed\n\tvar __webpack_exports__ = __webpack_require__.O(undefined, [704], () => (__webpack_require__(8307)))\n\t__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n\treturn __webpack_exports__;\n};\n\n","var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = (chunkId) => {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce((promises, key) => {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks and sibling chunks for the entrypoint\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"static/js/\" + chunkId + \".\" + \"1d33b919\" + \".chunk.js\";\n};","// This function allow to reference async chunks and sibling chunks for the entrypoint\n__webpack_require__.miniCssF = (chunkId) => {\n\t// return url for filenames based on template\n\treturn undefined;\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","__webpack_require__.p = \"/\";","// no baseURI\n\n// object to store loaded chunks\n// \"1\" means \"already loaded\"\nvar installedChunks = {\n\t307: 1\n};\n\n// importScripts chunk loading\nvar installChunk = (data) => {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\tfor(var moduleId in moreModules) {\n\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t}\n\t}\n\tif(runtime) runtime(__webpack_require__);\n\twhile(chunkIds.length)\n\t\tinstalledChunks[chunkIds.pop()] = 1;\n\tparentChunkLoadingFunction(data);\n};\n__webpack_require__.f.i = (chunkId, promises) => {\n\t// \"1\" is the signal for \"already loaded\"\n\tif(!installedChunks[chunkId]) {\n\t\tif(true) { // all chunks have JS\n\t\t\timportScripts(__webpack_require__.p + __webpack_require__.u(chunkId));\n\t\t}\n\t}\n};\n\nvar chunkLoadingGlobal = self[\"webpackChunknostr_chat\"] = self[\"webpackChunknostr_chat\"] || [];\nvar parentChunkLoadingFunction = chunkLoadingGlobal.push.bind(chunkLoadingGlobal);\nchunkLoadingGlobal.push = installChunk;\n\n// no HMR\n\n// no HMR manifest","var next = __webpack_require__.x;\n__webpack_require__.x = () => {\n\treturn __webpack_require__.e(704).then(next);\n};","// run startup\nvar __webpack_exports__ = __webpack_require__.x();\n"],"names":["Comlink","constructor","this","seenOn","subs","relays","pool","SimplePool","poolCreated","Date","now","setup","getPool","close","fetch","filters","quitMs","arguments","length","undefined","Promise","resolve","reject","sub","events","quit","unsub","timer","setTimeout","on","event","push","id","clearTimeout","subId","onEvent","Math","random","toString","slice","findHealthyRelay","relay","ensureRelay","e","Error","where","eventId","try_","ids","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","m","x","__webpack_exports__","O","deferred","result","chunkIds","fn","priority","notFulfilled","Infinity","i","fulfilled","j","Object","keys","every","key","splice","r","d","definition","o","defineProperty","enumerable","get","f","chunkId","all","reduce","promises","u","miniCssF","obj","prop","prototype","hasOwnProperty","call","p","installedChunks","importScripts","chunkLoadingGlobal","self","parentChunkLoadingFunction","bind","data","moreModules","runtime","pop","next","then"],"sourceRoot":""}